<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>R ile Mekansal Veri Analizi</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R ile Mekansal Veri Analizi</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Giriş</a>
</li>
<li>
  <a href="R_Mekansal.html">İçerik</a>
</li>
<li>
  <a href="Links.html">Ek Kaynaklar</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/flexdashboard">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R ile Mekansal Veri Analizi</h1>

</div>


<p><br></p>
<div id="mekansal-verilerin-okunmas-ve-yazlmas" class="section level1">
<h1><span class="header-section-number">1</span> Mekansal verilerin okunması ve yazılması</h1>
<div id="vektor-dosyalar" class="section level2">
<h2><span class="header-section-number">1.1</span> Vektör dosyaları</h2>
<p>Vektör dosyaları genellikle <code>shp</code>(Shapefile), <code>json</code>, <code>geojson</code> uzantılı dosyalar biçiminde bulunmaktadır. Diğer bir çok dosya biçimine ile ilgili bilgili <a href="https://en.0wikipedia.org/wiki/GIS_file_formats">wikipedia</a> içeriğinden öğrenilebilir. Ancak biz mevcut çalışmamızda genelikle <code>shp</code> vs <code>json</code> uzantılı dosyaları kullanacağız.</p>
<p>Başlangıç aşamasında <code>shp</code> vs <code>json</code> verileriyle ilgili olarak önemli bir ayrıntıyı belirtmekte fayda bulunmaktadır.</p>
<ul>
<li>Shapefile (<code>shp</code>) verileri zorunlu olarak beraberinde <code>.shx</code> <code>.dbf</code> türündeki verileri gerektirmektedir. <code>.shp</code> verileri yalnızca geometrik bilgileri saklarken bu veriler indeksler ve diğer sütunsal verilerin saklanmasını sağlamaktadır. Shapefile verileri indirildiğinde genellikle bu uzantılı veri dosyaları da beraberinde gelmektedir. O sebeple bu dosyaların silinmemesi, Shapefile dosyaları ie aktarma işlemleri yapılırken bu dosyaların isimleri değiştilmeden <code>.shp</code> uzantılı dosya ile aynı çalışma dizininde bulunması gerekmektedir.</li>
<li><code>json</code> ve <code>geojson</code> verileri ise Shapefile dosyalarınad farklı olarak yukarıda sayılan tüm bağımlılık gerektiren bilgileri text formatında kendi içinde saklamaktadır. Bu sebeple yalnızca tek dosya ile tüm bilgiler kontrol edilebilmektedir.</li>
</ul>
<pre class="r"><code>library(sf)
library(tidyverse)

nc &lt;- st_read(system.file(&quot;shape/nc.shp&quot;, package=&quot;sf&quot;))</code></pre>
<pre><code>## Reading layer `nc&#39; from data source `C:\Users\leventcan.gultekin\Documents\R\R-3.5.1\library\sf\shape\nc.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 100 features and 14 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
## epsg (SRID):    4267
## proj4string:    +proj=longlat +datum=NAD27 +no_defs</code></pre>
<pre class="r"><code>class(nc)</code></pre>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
<pre class="r"><code>attr(nc, &quot;sf_column&quot;)</code></pre>
<pre><code>## [1] &quot;geometry&quot;</code></pre>
<pre class="r"><code>print(nc[9:15], n = 3)</code></pre>
<pre><code>## Simple feature collection with 100 features and 6 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
## epsg (SRID):    4267
## proj4string:    +proj=longlat +datum=NAD27 +no_defs
## First 3 features:
##   BIR74 SID74 NWBIR74 BIR79 SID79 NWBIR79                       geometry
## 1  1091     1      10  1364     0      19 MULTIPOLYGON (((-81.47276 3...
## 2   487     0      10   542     3      12 MULTIPOLYGON (((-81.23989 3...
## 3  3188     5     208  3616     6     260 MULTIPOLYGON (((-80.45634 3...</code></pre>
<pre class="r"><code>str(nc)</code></pre>
<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   100 obs. of  15 variables:
##  $ AREA     : num  0.114 0.061 0.143 0.07 0.153 0.097 0.062 0.091 0.118 0.124 ...
##  $ PERIMETER: num  1.44 1.23 1.63 2.97 2.21 ...
##  $ CNTY_    : num  1825 1827 1828 1831 1832 ...
##  $ CNTY_ID  : num  1825 1827 1828 1831 1832 ...
##  $ NAME     : Factor w/ 100 levels &quot;Alamance&quot;,&quot;Alexander&quot;,..: 5 3 86 27 66 46 15 37 93 85 ...
##  $ FIPS     : Factor w/ 100 levels &quot;37001&quot;,&quot;37003&quot;,..: 5 3 86 27 66 46 15 37 93 85 ...
##  $ FIPSNO   : num  37009 37005 37171 37053 37131 ...
##  $ CRESS_ID : int  5 3 86 27 66 46 15 37 93 85 ...
##  $ BIR74    : num  1091 487 3188 508 1421 ...
##  $ SID74    : num  1 0 5 1 9 7 0 0 4 1 ...
##  $ NWBIR74  : num  10 10 208 123 1066 ...
##  $ BIR79    : num  1364 542 3616 830 1606 ...
##  $ SID79    : num  0 3 6 2 3 5 2 2 2 5 ...
##  $ NWBIR79  : num  19 12 260 145 1197 ...
##  $ geometry :sfc_MULTIPOLYGON of length 100; first list element: List of 1
##   ..$ :List of 1
##   .. ..$ : num [1:27, 1:2] -81.5 -81.5 -81.6 -81.6 -81.7 ...
##   ..- attr(*, &quot;class&quot;)= chr  &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA NA NA NA NA NA NA ...
##   ..- attr(*, &quot;names&quot;)= chr  &quot;AREA&quot; &quot;PERIMETER&quot; &quot;CNTY_&quot; &quot;CNTY_ID&quot; ...</code></pre>
<p>En basit haliyle <code>nc</code> dataframe’indeki <code>geometry</code> kolonuna <code>plot</code> fonksiyonu uygulandığında haritanın geometrisine ulaşabiliriz. Bu örneğimizde <code>geometry</code> alanı MULTIPOLYGON karakteristiğinde olduğu için karşımıza boş bir poligon harita çıktı. Eğer <code>geometry</code> alanı ilerdeki örneklerde sıkça göreceğimiz gibi MULTIPOLYGON karakteristiğinde olsaydı <code>plot</code> fonksiyonu uygulandıktan sonra karşımıza boş bir düzlemde dağılmış noktalar görecektik.</p>
<pre class="r"><code>plot(nc$geometry)</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="raster-dosyalar" class="section level2">
<h2><span class="header-section-number">1.2</span> Raster dosyaları</h2>
<p>Bu çalışmanın ana odağı raster odağı olmamak ile birlikte kısa bir gösterim yapabiliriz.</p>
<p>Daha uygun bir boyutta raster dosyası bulunabilir</p>
</div>
</div>
<div id="mekansal-katman-birlestirme" class="section level1">
<h1><span class="header-section-number">2</span> Mekansal Katman Birleştirme</h1>
<p>Gerçek hayattaki uygulamalarımızda genellikle mekana ilişkin verilerimiz <code>xlsx</code>, <code>csv</code> gibi dosyalarda veya veritabalarında iken mekansal geometrik veriler genellikle <code>shp</code>, <code>json</code>, `<code>geojson</code> gibi dosyalarda bulunmaktadır. Katman birleştirme (Spatial join) işlemi ile birlikte genellikle bu iki verinin birbiri ile eşleştirilmesini sağlarız.</p>
<p>Örnek olarak aşağıdaki veri setinden gidelim.</p>
<pre class="r"><code>library(readxl)

iller_nufus &lt;- read_excel(&quot;data/turkey/iller_nufus_2019.xlsx&quot;)
il_harita &lt;- st_read(&quot;data/turkey/TR3_Map.json&quot;)</code></pre>
<pre><code>## Reading layer `TR3_Map&#39; from data source `C:\Users\leventcan.gultekin\Documents\--DOSYALARIM\R-Projects\GitHub\Mekansal_Analiz_R\data\turkey\TR3_Map.json&#39; using driver `GeoJSON&#39;
## Simple feature collection with 81 features and 5 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 25.66851 ymin: 35.80857 xmax: 44.81861 ymax: 42.0985
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<p>İki dataframe nesnesi incelendiğinde ikisi arasında ortak olarak <code>NUTS_ID</code> ve <code>BOLGEKOD</code> alanlarının ortak olduğu görülmektedir.</p>
<pre class="r"><code>str(iller_nufus, max.level=3)</code></pre>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    81 obs. of  4 variables:
##  $ YIL     : num  2019 2019 2019 2019 2019 ...
##  $ BOLGEKOD: chr  &quot;TR100&quot; &quot;TR211&quot; &quot;TR212&quot; &quot;TR213&quot; ...
##  $ IL_ADI  : chr  &quot;Istanbul&quot; &quot;Tekirdag&quot; &quot;Edirne&quot; &quot;Kirklareli&quot; ...
##  $ NUFUS   : num  15519267 1055412 413903 361836 1228620 ...</code></pre>
<pre class="r"><code>str(il_harita, max.level=1)</code></pre>
<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   81 obs. of  6 variables:
##  $ STAT_LEVL_: int  3 3 3 3 3 3 3 3 3 3 ...
##  $ NUTS_ID   : Factor w/ 81 levels &quot;TR100&quot;,&quot;TR211&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ SHAPE_Leng: num  5.84 4.64 5.07 4.09 9.91 ...
##  $ SHAPE_Area: num  9342 11274 10567 11732 24327 ...
##  $ Country   : Factor w/ 1 level &quot;TR&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ geometry  :sfc_MULTIPOLYGON of length 81; first list element: List of 4
##   ..- attr(*, &quot;class&quot;)= chr  &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA NA
##   ..- attr(*, &quot;names&quot;)= chr  &quot;STAT_LEVL_&quot; &quot;NUTS_ID&quot; &quot;SHAPE_Leng&quot; &quot;SHAPE_Area&quot; ...</code></pre>
<p>Ortak olan kolonları kulllanrak <code>iller_nufus</code> dataframe’indeki tüm verileri <code>il_harita</code> dataframe’i ile birleştirebiliriz.</p>
<pre class="r"><code>il_harita &lt;- il_harita %&gt;% left_join(iller_nufus, by = c(&quot;NUTS_ID&quot;=&quot;BOLGEKOD&quot;))

head(il_harita)</code></pre>
<pre><code>## Simple feature collection with 6 features and 8 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 25.66851 ymin: 39.05698 xmax: 29.86549 ymax: 42.0985
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs
##   STAT_LEVL_ NUTS_ID SHAPE_Leng SHAPE_Area Country  YIL     IL_ADI
## 1          3   TR100   5.840081    9341.87      TR 2019   Istanbul
## 2          3   TR211   4.642952   11274.27      TR 2019   Tekirdag
## 3          3   TR212   5.072686   10566.52      TR 2019     Edirne
## 4          3   TR213   4.091844   11731.51      TR 2019 Kirklareli
## 5          3   TR221   9.907496   24326.62      TR 2019  Balikesir
## 6          3   TR222   8.304526   16693.71      TR 2019  Çanakkale
##      NUFUS                       geometry
## 1 15519267 MULTIPOLYGON (((29.05575 41...
## 2  1055412 MULTIPOLYGON (((28.18284 41...
## 3   413903 MULTIPOLYGON (((26.88127 41...
## 4   361836 MULTIPOLYGON (((28.02801 41...
## 5  1228620 MULTIPOLYGON (((27.89804 40...
## 6   542157 MULTIPOLYGON (((27.31631 40...</code></pre>
<p>Bu işlemi yaptıktan sonra il bazında nüfusu gösteren tematik harita ve diğer çeşitli mekansal analizler yapılabilir. Ancak şu aşamada bu örneği burada bırakmak istiyorum. Gelecek bölümlerdeki çalışmalarda uluslararası diğer zengin veri kaynaklarını tercih edeceğim. Özellikle <a href="https://geodacenter.github.io/data-and-lab//">GEO DA Center</a>’ da yer alan verileri. Burada yer alan mekansal veriler genellikle <code>shp</code> veya <code>json</code> verileri içerisine katman birleştirme işlemi hali yapılmış şekilde araştırmacılara sunulmaktadır. Dolayısıyla ileriki görselleştirme ve mekansal ekonometri ile ilgili bölümlerde katman birleştirme işlemini yapmayacağız. Ancak gerçek hayattaki araştırmaların neredeyse hepsinde katman birleştirme işlemleri uygulamak gerektiği için yukarıdaki iş akışını bilmekte fayda bulunmaktadır.</p>
</div>
<div id="veri-gorsellestirme" class="section level1">
<h1><span class="header-section-number">3</span> Veri Görselleştirme</h1>
<p>Çalışmada örnek veriseti olarak <a href="https://geodacenter.github.io/data-and-lab//NYC_Tract_ACS2008_12/">NYC socio demographics</a> veri setini kullanıyoruz.</p>
<pre class="r"><code>nyc &lt;- st_read(&quot;data/nyctract_acs/NYC_Tract_ACS2008_12.shp&quot;)</code></pre>
<pre><code>## Reading layer `NYC_Tract_ACS2008_12&#39; from data source `C:\Users\leventcan.gultekin\Documents\--DOSYALARIM\R-Projects\GitHub\Mekansal_Analiz_R\data\nyctract_acs\NYC_Tract_ACS2008_12.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 2166 features and 113 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -74.25559 ymin: 40.49612 xmax: -73.70001 ymax: 40.91553
## epsg (SRID):    NA
## proj4string:    NA</code></pre>
<pre class="r"><code>library(tmap)

tm_shape(nyc) +
  tm_polygons()</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Her bir mahalledeki Hispanik kökenli nüfüsun toplam nüfus içerisindeki payını hesaplayalım.</p>
<pre class="r"><code>nyc$hispanic_share &lt;- nyc$hispanic/nyc$poptot

tm_shape(nyc) +
  tm_polygons(&quot;hispanic_share&quot;)</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Objemizde koordinat referans sisteminin tanımlanmadığını görüyoruz</p>
<pre class="r"><code>st_crs(nyc)</code></pre>
<pre><code>## Coordinate Reference System: NA</code></pre>
<pre class="r"><code>tm_shape(nyc) +
  tm_bubbles(&quot;hispanic_share&quot;)</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>tmap paketi içerisinde projeksiyonlar daha önceden veri yapısı değiştirilmeden görselleştirme esnasında değiştirilebilmektedir.</p>
<pre class="r"><code>tm_shape(nyc) +
  tm_polygons(&quot;hispanic_share&quot;)</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p><code>tmap</code> paketinin en avantajlı yani tematik haritaların çok az kodla temiz bir şekilde üretebilmemize imkan tanımasıdır. R ekosistemindeki görselleştirme alanındaki en iyi paket kuşkusuz <code>ggplot2</code> paketidir. <code>ggplot2</code> ile mekansal veri görselleştirmesine ek olarak bir çok türdeki statik görselleştirme çok başarılı şekilde yapılabilmekte, kullanıcıya çok fazla esneklik tanınmaktadır. Ancak <code>ggplot2</code> doğası itibariyle kullanıcıya genelleştirilmiş bir çerçeve sunduğu için, baskıya hazır br coğrafi görselleştirmede <code>tmap</code>’e kıyasla çok daha fazla kullanıcın özelleştirilmiş kod yazmasını gerektirmektedir. Kimi zaman çok kompleks bir işi gerçekleştirmek istediğimizde <code>ggplo2</code>’yi kullanabiliriz. Ama çoğu durumda <code>tmap</code> yeterli bir seçenektir.</p>
<p>Şimdi yukarıda yaptığımız haritayı biraz daha özelleştirelim!</p>
<p>Yukarıda gördüğünüz gibi lejand alanı otomatik olarak verinin minimum-maximum aralığını (range) 5’ bölmüş buna uygun olarak renklendirmeleri yapmıştır. Bundan farklı olarak aşağıdaki seçenekleri kullanarak farklı bölümleme yöntemlerini uygulayabiliz.</p>
<ul>
<li>quantile</li>
<li>jenks</li>
<li>pretty</li>
<li>equal</li>
<li>sd</li>
</ul>
<pre class="r"><code>tm_shape(nyc) +
  tm_polygons(&quot;hispanic_share&quot;,
              style = &quot;pretty&quot;,
              palette = &quot;Reds&quot;) +
  tm_legend(legend.position = c(&quot;left&quot;, &quot;top&quot;))</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Bölümleme işlemini manual olarak da ayarlayabiliriz.</p>
<pre class="r"><code>cuts &lt;- c(0, 0.1, 0.4, 0.8, 1)

tm_shape(nyc) +
  tm_polygons(&quot;hispanic_share&quot;,
              breaks = cuts,
              palette = &quot;Reds&quot;,
              border.col = &quot;white&quot;, 
              border.alpha = 0.5) +
  tm_legend(legend.position = c(&quot;left&quot;, &quot;top&quot;))</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Paletde renk sırası aşağıdaki şekilde tersine çevirilebilir. Ancak çalıştığımız bu örnek açısından daha iyi oldu denemez</p>
<pre class="r"><code>tm_shape(nyc) +
  tm_polygons(&quot;hispanic_share&quot;,
              style = &quot;pretty&quot;,
              palette = &quot;-Reds&quot;,
              border.col = &quot;white&quot;, 
              border.alpha = 0.5) +
  tm_legend(legend.position = c(&quot;left&quot;, &quot;top&quot;))</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Kendi renk paletimizi de tanımlayabiliriz</p>
<pre class="r"><code>mycols &lt;- c(&quot;#f0f4c3&quot;, &quot;#dce775&quot;, &quot;#cddc39&quot;, &quot;#afb42b&quot;, &quot;#827717&quot;)

tm_shape(nyc) +
  tm_polygons(&quot;hispanic_share&quot;,
              style = &quot;pretty&quot;,
              palette = mycols,
              border.col = &quot;white&quot;, 
              border.alpha = 0.5) +
  tm_legend(legend.position = c(&quot;left&quot;, &quot;top&quot;))</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Lejandımızın ve grafiğimizin başlığını değiştirebiliriz</p>
<pre class="r"><code>mymap &lt;- tm_shape(nyc) +
  tm_polygons(&quot;hispanic_share&quot;,
              style = &quot;quantile&quot;,
              palette = &quot;BuPu&quot;,
              border.col = &quot;white&quot;, 
              border.alpha = 0.5,
              title = &quot;Hispanik Nüfus Oranı (%)&quot;) +
  tm_legend(legend.position = c(0.01, 0.5)) +
  tm_layout(title = &quot;New York&#39;da Hispanik Nüfusun Dağılımı&quot;,
    title.size = 1.1,
    title.position = c(&quot;center&quot;, &quot;top&quot;)) +
  tm_layout(inner.margins = c(0.06, 0.10, 0.10, 0.08),
            frame = FALSE)

mymap</code></pre>
<p><img src="R_Mekansal_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Yapmış olduğunuz haritayı aşağıdaki şekilde bilgisayarınıza kaydedebilirsiniz</p>
<pre class="r"><code>tmap_save(mymap,&quot;newyork-hispanics.png&quot;, height = 6, width = 6, dpi=600)</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
